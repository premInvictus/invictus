<!-- pattern="[0-9]{1}|[0-9]{2}|[0-9]{3}|[A-C]{1}" -->
<div class="row">
    <div class="col-12 ">
        <button class="top-close-btn" mat-button (click)="closeDialog()">Close <i
                class="fas fa-times font-size-16 margin-left-15"></i></button>
    </div>
</div>
<table id="gradecard" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td>
            <div class="row" *ngIf="schoolDetails">
                <div class="col-12">
                    <div class="row">
                        <div class="col-12">
                            <div class="header" [innerHTML]="header" style="height: 80px; display: inline-flex;"></div>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-12 text-center" *ngIf="studentDetails">
                    <span class="font-size-20 font-bold">Academic Session : {{currentSession.ses_name}}</span><br>
                    <span class="font-size-20 font-bold">Report Card for Class {{studentDetails.class_name}}</span>
                </div>
            </div>
            <div class="row">
                <div class="col-6" *ngIf="studentDetails">
                    <table>
                        <tr>
                            <td><span>Roll no.</span></td>
                            <td><span>:</span></td>
                            <td>{{studentDetails.r_rollno}}</td>
                        </tr>
                        <tr>
                            <td><span>Student's Name</span></td>
                            <td><span>:</span></td>
                            <td>{{studentDetails.au_full_name | titlecase}}</td>
                        </tr>
                        <tr>
                            <td><span>Mother's/Father's/Guardian's Name</span></td>
                            <td><span>:</span></td>
                            <td>{{studentDetails.active_parent_name | titlecase}}</td>
                        </tr>
                        <tr>
                            <td><span>Date of Birth</span></td>
                            <td><span>:</span></td>
                            <td>{{studentDetails.upd_dob | date:'d-MMM-y'}}</td>
                        </tr>
                        <tr>
                            <td><span>Class/Section</span></td>
                            <td><span>:</span></td>
                            <td>{{studentDetails.class_name}} - {{studentDetails.sec_name}}</td>
                        </tr>
                    </table>
                </div>
                <div class="col-6 text-right">
                    <img style="width: 120px; height: 140px" [src]="defaultsrc"
                        onError="this.src='https://s3.ap-south-1.amazonaws.com/files.invictusdigisoft.com/images/man.svg'">
                    <!-- <div [ngStyle]="{'background-image': 'url(' + defaultsrc + ')', 'height':'140px', 'width': '120px'}"></div> -->
                </div>
            </div>
            <ng-template [ngIf]="data.ect_exam_type == 2" [ngIfElse]="ccepattern">
                <div class="row" *ngFor="let term of termArray">
                    <div class="col-12" *ngIf="sflag && eflag && gflag">
                        <table class="table-100 custom-table" style="margin-bottom: 15px">
                            <thead>
                                <tr class="custom-tr">
                                    <th class="custom-th text-center" width="200px">Scholastic Areas</th>
                                    <th [attr.colspan]="sexamArray.length + 2" class="custom-th text-center">Term -{{term}}
                                        ({{acedemicmarks}} Marks)</th>
                                </tr>
                                <tr class="custom-tr">
                                    <th class="custom-th text-center">Subject Name</th>
                                    <th class="custom-th text-center" *ngFor="let item of sexamArray">
                                        {{item.exam_name | titlecase}}
                                        <br>({{item.exam_weightage}})</th>
                                    <th class="custom-th text-center">Marks Obtained<br>({{acedemicmarks}})</th>
                                    <th class="custom-th text-center">Grade</th>
                                </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let sub of subjectArray">
                                    <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                        <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}</td>
                                        <td class="custom-td" *ngFor="let item of sexamArray">
                                            {{getCalculatedMarksSub(sub.sub_id, item.exam_id,term)}}</td>
                                        <td class="custom-td">{{calculateTotal(sub.sub_id,term)}}</td>
                                        <td class="custom-td">{{calculateGrade(sub.sub_id,term)}}</td>
                                    </tr>
                                </ng-container>
                            </tbody>

                        </table>
                    </div>
                    <div class="col-6" *ngIf="sflag && eflag && gflag && cexamArray.length > 0">
                        <table class="custom-table table-100">
                            <thead>
                                <tr class="custom-tr">
                                    <th class="custom-th padding-left-8px">Co-Scholastic Areas [on a 3-point A-C grading
                                        scale ]
                                    </th>
                                    <th class="custom-th text-center">Grade</th>
                                </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let sub of subjectArray">
                                    <tr *ngIf="sub.sub_type == 2">
                                        <td class="custom-td padding-left-8px text-left">{{sub.sub_name}} </td>
                                        <td class="custom-td text-center">
                                            {{calculateGradePoint(sub.sub_id, term)}}
                                        </td>
                                    </tr>
                                </ng-container>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- <div class="row">
                    <div class="col-6">
                        <table class="custom-table table-100">
                            <thead>
                                <tr class="custom-tr">
                                    <th class="custom-th padding-left-8px"> </th>
                                    <th class="custom-th text-center">Grade</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="custom-td padding-left-8px text-left">Discpline [on a 5-point AE grading
                                        scale ]</td>
                                    <td class="custom-td text-center"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div> -->
            </ng-template>
            <ng-template #ccepattern>
                <div class="row" *ngFor="let term of termArray">
                    <div class="col-12" *ngIf="sflag && eflag && gflag">
                        <table class="table-100 custom-table" style="margin-bottom: 15px">
                            <thead>
                                <tr class="custom-tr">
                                    <th class="custom-th text-center" width="200px">Scholastic Areas</th>
                                    <th [attr.colspan]="2" class="custom-th text-center">Term -{{term}} </th>
                                </tr>
                                <tr class="custom-tr">
                                    <th class="custom-th text-center">Subject Name</th>
                                    <!-- <th class="custom-th text-center" *ngFor="let item of sexamArray">
                                        {{item.exam_name | titlecase}}
                                        <br>({{item.exam_weightage}})</th> -->
                                    <th class="custom-th text-center" width="60px">Grade</th>
                                    <th class="custom-th text-center">Remark</th>
                                </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let sub of subjectArray">
                                    <ng-template [ngIf]="sub.childSub.length == 0" [ngIfElse]="childdiv">
                                        <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                            <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}</td>
                                            <!-- <td class="custom-td" *ngFor="let item of sexamArray">
                                                {{getGradePoint(getCalculatedMarks(sub.sub_id, item.exam_id,term))}}
                                            </td> -->
                                            <td class="custom-td">{{calculateGradeCcePoint(sub.sub_id,term)}}</td>
                                            <td class="custom-td">{{remarkOfSub(sub.sub_id) | titlecase}}</td>
                                        </tr>
                                    </ng-template>
                                    <ng-template #childdiv>
                                        <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                            <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}</td>
                                            <!-- <td class="custom-td" *ngFor="let item of sexamArray"></td> -->
                                            <td class="custom-td"></td>
                                            <td class="custom-td"></td>
                                        </tr>
                                        <ng-container *ngFor="let sub1 of sub.childSub">
                                            <tr class="custom-tr" *ngIf="sub1.sub_type == 1">
                                                <td class="custom-td text-left padding-left-8px">{{sub1.sub_name}}</td>
                                                <!-- <td class="custom-td" *ngFor="let item of sexamArray">
                                                    {{getGradePoint(getCalculatedMarks(sub1.sub_id, item.exam_id,term))}}
                                                </td> -->
                                                <td class="custom-td">{{calculateGradeCcePoint(sub1.sub_id,term)}}</td>
                                                <td class="custom-td">{{remarkOfSub(sub1.sub_id) | titlecase}}</td>
                                            </tr>
                                        </ng-container>
                                    </ng-template>
                                </ng-container>
                            </tbody>

                        </table>
                    </div>
                    <div class="col-6" *ngIf="sflag && eflag && gflag && cexamArray.length > 0">
                        <table class="custom-table table-100">
                            <thead>
                                <tr class="custom-tr">
                                    <th class="custom-th padding-left-8px">Co-Scholastic Areas [on a 3-point A-C grading
                                        scale ]
                                    </th>
                                    <th class="custom-th text-center">Grade</th>
                                </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let sub of subjectArray">
                                    <tr *ngIf="sub.sub_type == 2">
                                        <td class="custom-td padding-left-8px text-left">{{sub.sub_name}} </td>
                                        <td class="custom-td text-center">
                                            {{calculateGradePoint(sub.sub_id, term)}}
                                        </td>
                                    </tr>
                                </ng-container>
                            </tbody>
                        </table>
                    </div>
                </div>
            </ng-template>

            <div class="row" *ngIf="resultdivflag && data.ect_exam_type == 2">
                <div class="col-6">
                    <table>
                        <thead>
                            <tr><br></tr>
                            <tr>
                                <th>Class Teacher's Remarks</th>
                                <th>: {{remarkOfSub() | titlecase}}</th>
                            </tr>
                            <tr><br></tr>
                            <tr class="margin-top-10">
                                <th style="text-align: left">Result</th>
                                <th>: {{getPassResult(data.param.eme_term_id)}}</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <table class="table-100">
                        <tr>
                            <th height="80" style="text-align: left; vertical-align: bottom;">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>: {{today | date:'d-MMM-y'}}</th>
                                        </tr>
                                    </thead>
                                </table>
                            </th>
                            <th style="text-align: center; vertical-align: bottom;" height="80">
                                <table>
                                    <thead>
                                        <tr>
                                            <th *ngIf="useTeacherSignature === '1' && teacherSignature"> <img
                                                    [src]="teacherSignature" height="60px" width="160px"></th>
                                        </tr>
                                        <tr>
                                            <th>Signature of Class Teacher</th>
                                        </tr>
                                    </thead>
                                </table>
                            </th>
                            <th style="text-align: right; vertical-align: bottom;" height="80">
                                <table>
                                    <thead>
                                        <tr>
                                            <th *ngIf="usePrincipalSignature === '1' && principalSignature"> <img
                                                    [src]="principalSignature" height="60px" width="120px"></th>
                                        </tr>
                                        <tr>
                                            <th>Signature of Principal</th>
                                        </tr>
                                    </thead>
                                </table>
                            </th>
                        </tr>
                    </table>
                </div>
            </div>
            <hr>
            <div class="row" *ngIf="data.ect_exam_type == 2">
                <div class="col-12">
                    <span><b>Grading Scale for scholatic Area</b></span><span> : Grades are awarded on a 8-pont grading
                        scale as
                        follows</span>
                </div>
            </div>
            <div class="row" *ngIf="data.ect_exam_type == 2">
                <div class="col-3"></div>
                <div class="col-6">

                    <div style="margin-top: 15px; text-align: center; width: 100%;">
                        <table style="width:100%; border: 1px solid black;border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="border: 1px solid black;border-collapse: collapse;padding: 5px">Marks
                                        Range </th>
                                    <th style="border: 1px solid black;border-collapse: collapse;padding: 5px">Grade
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of GradeSet">
                                    <td style="border: 1px solid black;border-collapse: collapse;padding: 5px">
                                        {{item.egs_range_start}} - {{item.egs_range_end}}
                                    </td>
                                    <td style="border: 1px solid black;border-collapse: collapse;padding: 5px">
                                        {{item.egs_grade_name | titlecase}}</td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-3"></div>
            </div>
            <br>
            <div class="">
                <div [innerHTML]="footer"></div>
                <div style="width: 100%; height:10px; background-color:#f4981e;"></div>
                <div style="width: 100%; height:10px; background-color:#159ec4"></div>

            </div>
        </td>
    </tr>
</table>