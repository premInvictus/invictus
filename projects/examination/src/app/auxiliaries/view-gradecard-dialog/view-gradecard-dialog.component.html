<!-- pattern="[0-9]{1}|[0-9]{2}|[0-9]{3}|[A-C]{1}" -->
<div class="row">
    <div class="col-12 ">
        <button class="top-close-btn" mat-button (click)="closeDialog()">Close <i
                class="fas fa-times font-size-16 margin-left-15"></i></button>
    </div>
</div>
<table id="gradecard" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td>
            <div class="row" *ngIf="schoolDetails">
                <div class="col-12">
                    <div class="row">
                        <div class="col-12">
                            <div class="header" [innerHTML]="header" style="height: 80px; display:contents;"></div>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-12 text-center" *ngIf="studentDetails">
                    <span class="font-size-20 font-bold">Academic Session : {{currentSession.ses_name}}</span><br>
                    <span class="font-size-20 font-bold">Report Card for Class {{studentDetails.class_name}}</span>
                </div>
            </div>
            <div class="row">
                <div class="col-5" *ngIf="studentDetails">
                    <table>
                        <tr>
                            <td><span>Roll no.</span></td>
                            <td><span>:</span></td>
                            <td>{{studentDetails.r_rollno}}</td>
                        </tr>
                        <tr>
                            <td><span>Student's Name</span></td>
                            <td><span>:</span></td>
                            <td>{{studentDetails.au_full_name | titlecase}}</td>
                        </tr>
                        <tr>
                            <td><span>Mother's/Father's/Guardian's Name</span></td>
                            <td><span>:</span></td>
                            <td>{{studentDetails.active_parent_name | titlecase}}</td>
                        </tr>
                        <tr>
                            <td><span>Date of Birth</span></td>
                            <td><span>:</span></td>
                            <td>{{studentDetails.upd_dob | date:'d-MMM-y'}}</td>
                        </tr>
                        <tr>
                            <td><span>Class/Section</span></td>
                            <td><span>:</span></td>
                            <td>{{studentDetails.class_name}} - {{studentDetails.sec_name}}</td>
                        </tr>
                    </table>
                </div>
                <div class="col-4" *ngIf="studentDetails">
                    <table>
                        <tr>
                            <td><span>No. of Days Present</span></td>
                            <td><span>:</span></td>
                            <td>{{totalpresentday}}</td>
                        </tr>
                        <tr>
                            <td><span>Total Working Days</span></td>
                            <td><span>:</span></td>
                            <td>{{totalworkingdays}}</td>
                        </tr>
                        <tr>
                            <td><span>Attendance(%)</span></td>
                            <td><span>:</span></td>
                            <td>{{attendenceInPercent}}%</td>
                        </tr>
                    </table>
                </div>
                <div class="col-3 text-right">
                    <img style="width: 80px; height: 100px" [src]="defaultsrc"
                        onError="this.src='https://s3.ap-south-1.amazonaws.com/files.invictusdigisoft.com/images/man.svg'">
                    <!-- <div [ngStyle]="{'background-image': 'url(' + defaultsrc + ')', 'height':'140px', 'width': '120px'}"></div> -->
                </div>
            </div>
            <ng-container *ngIf="data.param.eme_subexam_id && data.param.eme_subexam_id.length > 0">
                <ng-template [ngIf]="data.ect_exam_type == 2">
                    <ng-template [ngIf]="obtainedGradeAvgHighest.subjectwise_bifurcation"
                        [ngIfElse]="not_subjectwise_bifurcation_subexam">
                        <div class="row" *ngFor="let term of termArray">
                            <div class="col-12" *ngIf="sflag && eflag && gflag && sexamArray.length > 0">
                                <table class="table-100 custom-table" style="margin-bottom: 15px">
                                    <thead>
                                        <tr class="custom-tr">
                                            <th [attr.colspan]="2" class="custom-th text-center" width="200px">Scholastic Areas</th>
                                            <ng-container *ngIf="term == data.param.eme_term_id">
                                                <th [attr.colspan]="(sexamArray[0].exam_sub_exam_max_marks.length) * 2"
                                                    class="custom-th text-center">
                                                    Term-{{term}}</th>
                                            </ng-container>
                                        </tr>
                                        <tr class="custom-tr">
                                            <th [attr.colspan]="2" class="custom-th text-center">Subject Name</th>
                                            <th [attr.colspan]="2" class="custom-th text-center"
                                                *ngFor="let item of sexamArray[0].exam_sub_exam_max_marks">
                                                {{item.sexam_name | titlecase}}
                                                <br>({{item.exam_max_marks}})</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- <ng-container *ngFor="let sub of subjectArray">
                                            <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                <ng-container *ngIf="sub.ess_additional == 0">
                                                    <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}
                                                    </td>
                                                </ng-container>
                                                <ng-container *ngIf="sub.ess_additional == 1">
                                                    <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}
                                                        (Add.)
                                                    </td>
                                                </ng-container>
                                                <td class="custom-td"
                                                    *ngFor="let item of sexamArray[0].exam_sub_exam_max_marks">
                                                    {{getCalculatedMarksSubSubexam(sub.sub_id, data.param.eme_exam_id, term, item.se_id)}}
                                                </td>

                                            </tr>
                                        </ng-container> -->
                                        <ng-container *ngFor="let sub of subjectArray">
                                            <ng-template [ngIf]="sub.childSub.length == 0" [ngIfElse]="childdiv_subexam">
                                                <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                    <ng-container *ngIf="sub.ess_additional == 0">
                                                        <td [attr.colspan]="2"
                                                            class="custom-td text-left padding-left-8px">
                                                            {{sub.sub_name}}</td>
                                                    </ng-container>
                                                    <ng-container *ngIf="sub.ess_additional == 1">
                                                        <td [attr.colspan]="2"
                                                            class="custom-td text-left padding-left-8px">
                                                            {{sub.sub_name}} (Add.)
                                                        </td>
                                                    </ng-container>
                                                    <ng-container *ngFor="let item of sexamArray[0].exam_sub_exam_max_marks">
                                                        <td class="custom-td"></td>
                                                        <td class="custom-td">
                                                            {{getCalculatedMarksSubSubexam(sub.sub_id, data.param.eme_exam_id, term, item.se_id)}}
                                                        </td>
                                                    </ng-container>
                                                </tr>
                                            </ng-template>
                                            <ng-template #childdiv_subexam>
                                                <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                    <ng-container *ngIf="sub.ess_additional == 0">
                                                        <td [attr.rowspan]="sub.childSub.length"
                                                            class="custom-td text-left padding-left-8px">
                                                            {{sub.sub_name}}
                                                        </td>
                                                    </ng-container>
                                                    <ng-container *ngIf="sub.ess_additional == 1">
                                                        <td [attr.rowspan]="sub.childSub.length"
                                                            class="custom-td text-left padding-left-8px">
                                                            {{sub.sub_name}}
                                                            (Add.)
                                                        </td>
                                                    </ng-container>
                                                    <td class="custom-td text-left padding-left-8px">
                                                        {{sub.childSub[0].sub_name}}</td>
                                                    <ng-container *ngFor="let item of sexamArray[0].exam_sub_exam_max_marks">
                                                        <td class="custom-td">
                                                            {{getCalculatedMarksSubexam(sub.childSub[0].sub_id, data.param.eme_exam_id, term, item.se_id)}}
                                                        </td>
                                                        <td [attr.rowspan]="sub.childSub.length" class="custom-td">
                                                            {{getCalculatedMarksSubSubexam(sub.sub_id, data.param.eme_exam_id, term, item.se_id)}}
                                                        </td>
                                                    </ng-container>
                                                </tr>
                                                <ng-container *ngFor="let sub1 of sub.childSub; let i=index">
                                                    <tr class="custom-tr" *ngIf="sub1.sub_type == 1 && i!=0">
                                                        <td class="custom-td text-left padding-left-8px">
                                                            {{sub1.sub_name}}
                                                        </td>
                                                        <ng-container *ngFor="let item of sexamArray[0].exam_sub_exam_max_marks">
                                                            <td class="custom-td">
                                                                {{getCalculatedMarksSubexam(sub1.sub_id, data.param.eme_exam_id, term, item.se_id)}}
                                                            </td>
                                                        </ng-container>
                                                    </tr>
                                                </ng-container>
                                            </ng-template>
                                        </ng-container>
                                    </tbody>

                                </table>
                            </div>
                        </div>
                    </ng-template>
                    <ng-template #not_subjectwise_bifurcation_subexam>
                        <div class="row" *ngFor="let term of termArray">
                            <div class="col-12" *ngIf="sflag && eflag && gflag && sexamArray.length > 0">
                                <table class="table-100 custom-table" style="margin-bottom: 15px">
                                    <thead>
                                        <tr class="custom-tr">
                                            <th class="custom-th text-center" width="200px">Scholastic Areas</th>
                                            <ng-container *ngIf="term == data.param.eme_term_id">
                                                <th [attr.colspan]="sexamArray[0].exam_sub_exam_max_marks.length"
                                                    class="custom-th text-center">
                                                    Term-{{term}}</th>
                                            </ng-container>
                                        </tr>
                                        <tr class="custom-tr">
                                            <th class="custom-th text-center">Subject Name</th>
                                            <th class="custom-th text-center"
                                                *ngFor="let item of sexamArray[0].exam_sub_exam_max_marks">
                                                {{item.sexam_name | titlecase}}
                                                <br>({{item.exam_max_marks}})</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ng-container *ngFor="let sub of subjectArray">
                                            <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                <ng-container *ngIf="sub.ess_additional == 0">
                                                    <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}
                                                    </td>
                                                </ng-container>
                                                <ng-container *ngIf="sub.ess_additional == 1">
                                                    <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}
                                                        (Add.)
                                                    </td>
                                                </ng-container>
                                                <td class="custom-td"
                                                    *ngFor="let item of sexamArray[0].exam_sub_exam_max_marks">
                                                    {{getCalculatedMarksSubSubexam(sub.sub_id, data.param.eme_exam_id, term, item.se_id)}}
                                                </td>

                                            </tr>
                                        </ng-container>
                                    </tbody>

                                </table>
                            </div>
                        </div>
                    </ng-template>
                </ng-template>
            </ng-container>
            <ng-container *ngIf="!(data.param.eme_subexam_id && data.param.eme_subexam_id.length > 0)">
                <ng-template [ngIf]="data.ect_exam_type == 2" [ngIfElse]="ccepattern">
                    <ng-template [ngIf]="obtainedGradeAvgHighest.subjectwise_bifurcation"
                        [ngIfElse]="not_subjectwise_bifurcation">
                        <div class="row" *ngFor="let term of termArray">
                            <div class="col-12" *ngIf="sflag && eflag && gflag && sexamArray.length > 0">
                                <table class="table-100 custom-table" style="margin-bottom: 15px">
                                    <thead>
                                        <tr class="custom-tr">
                                            <th [attr.colspan]="2" class="custom-th text-center" width="200px">
                                                Scholastic
                                                Areas</th>
                                            <ng-container *ngIf="term == data.param.eme_term_id">
                                                <th [attr.colspan]="sexamArray.length + exambifurcateCount + obtainedGradeAvgHighestCount"
                                                    class="custom-th text-center">
                                                    Term
                                                    -{{term}}
                                                    ({{acedemicmarks}} Marks)</th>
                                            </ng-container>
                                            <!-- <ng-template #elseheader>
                                                <th [attr.colspan]="sexamArray.length*2 + 2" class="custom-th text-center">
                                                    Term
                                                    -{{term}}
                                                    ({{acedemicmarks}} Marks)</th>
                                            </ng-template> -->
                                        </tr>
                                        <tr class="custom-tr">
                                            <th [attr.colspan]="2" class="custom-th text-center">Subject Name</th>
                                            <ng-container *ngFor="let item of sexamArray">
                                                <th [attr.colspan]="getExambirfurcateColspan(item)" class="custom-th text-center">
                                                    {{item.exam_name | titlecase}}
                                                    <br>({{item.exam_weightage}})</th>
                                            </ng-container>

                                            <th *ngIf="obtainedGradeAvgHighest.obtained" class="custom-th text-center">
                                                Marks
                                                Obtained<br>({{acedemicmarks}})</th>
                                            <th *ngIf="obtainedGradeAvgHighest.grade" class="custom-th text-center">
                                                Grade
                                            </th>
                                            <ng-container *ngIf="term == data.param.eme_term_id">
                                                <th *ngIf="obtainedGradeAvgHighest.avg" class="custom-th text-center">
                                                    Average
                                                </th>
                                                <th *ngIf="obtainedGradeAvgHighest.highest"
                                                    class="custom-th text-center">
                                                    Highest</th>
                                            </ng-container>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- <ng-container *ngFor="let sub of subjectArray">
                                            <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                <ng-container *ngIf="sub.ess_additional == 0">
                                                    <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}</td>
                                                </ng-container>
                                                <ng-container *ngIf="sub.ess_additional == 1">
                                                    <td class="custom-td text-left padding-left-8px">{{sub.sub_name}} (Add.)
                                                    </td>
                                                </ng-container>
                                                <td class="custom-td" *ngFor="let item of sexamArray">
                                                    {{getCalculatedMarksSub(sub.sub_id, item.exam_id,term)}}</td>
                                                <td *ngIf="obtainedGradeAvgHighest.obtained" class="custom-td">
                                                    {{calculateTotal(sub.sub_id,term)}}
                                                    {{getSubjectPassResult(sub.sub_id,term)}}</td>
                                                <td *ngIf="obtainedGradeAvgHighest.grade" class="custom-td">
                                                    {{calculateGrade(sub.sub_id,term)}}</td>
                                                <ng-container *ngIf="term == data.param.eme_term_id">
                                                    <td *ngIf="obtainedGradeAvgHighest.avg" class="custom-td">
                                                        {{getClassAverage(sub.sub_id)}}</td>
                                                    <td *ngIf="obtainedGradeAvgHighest.highest" class="custom-td">
                                                        {{getClassHighest(sub.sub_id)}}</td>
                                                </ng-container>
    
                                            </tr>
                                        </ng-container> -->
                                        <ng-container *ngFor="let sub of subjectArray">
                                            <ng-template [ngIf]="sub.childSub.length == 0" [ngIfElse]="childdiv">
                                                <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                    <ng-container *ngIf="sub.ess_additional == 0">
                                                        <td [attr.colspan]="2"
                                                            class="custom-td text-left padding-left-8px">
                                                            {{sub.sub_name}}</td>
                                                    </ng-container>
                                                    <ng-container *ngIf="sub.ess_additional == 1">
                                                        <td [attr.colspan]="2"
                                                            class="custom-td text-left padding-left-8px">
                                                            {{sub.sub_name}} (Add.)
                                                        </td>
                                                    </ng-container>
                                                    <ng-container *ngFor="let item of sexamArray">
                                                        <td class="custom-td" *ngIf="item.exam_bifurcate.bifurcated_marks"></td>
                                                        <td class="custom-td">
                                                            {{getCalculatedMarksSub(sub.sub_id, item.exam_id,term)}}
                                                        </td>
                                                    </ng-container>
                                                    <td *ngIf="obtainedGradeAvgHighest.obtained" class="custom-td">
                                                        {{calculateTotal(sub.sub_id,term)}}
                                                        {{getSubjectPassResult(sub.sub_id,term)}}</td>
                                                    <td *ngIf="obtainedGradeAvgHighest.grade" class="custom-td">
                                                        {{calculateGrade(sub.sub_id,term)}}</td>
                                                    <ng-container *ngIf="term == data.param.eme_term_id">
                                                        <td *ngIf="obtainedGradeAvgHighest.avg" class="custom-td">
                                                            {{getClassAverage(sub.sub_id)}}</td>
                                                        <td *ngIf="obtainedGradeAvgHighest.highest" class="custom-td">
                                                            {{getClassHighest(sub.sub_id)}}</td>
                                                    </ng-container>
                                                </tr>
                                            </ng-template>
                                            <ng-template #childdiv>
                                                <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                    <ng-container *ngIf="sub.ess_additional == 0">
                                                        <td [attr.rowspan]="sub.childSub.length"
                                                            class="custom-td text-left padding-left-8px">
                                                            {{sub.sub_name}}
                                                        </td>
                                                    </ng-container>
                                                    <ng-container *ngIf="sub.ess_additional == 1">
                                                        <td [attr.rowspan]="sub.childSub.length"
                                                            class="custom-td text-left padding-left-8px">
                                                            {{sub.sub_name}}
                                                            (Add.)
                                                        </td>
                                                    </ng-container>
                                                    <td class="custom-td text-left padding-left-8px">
                                                        {{sub.childSub[0].sub_name}}</td>
                                                    <ng-container *ngFor="let item of sexamArray">
                                                        <td class="custom-td" *ngIf="item.exam_bifurcate.bifurcated_marks">
                                                            {{getCalculatedMarksSubsubject(sub.sub_id, item.exam_id,term,sub.childSub[0].sub_id)}}
                                                        </td>
                                                        <td [attr.rowspan]="sub.childSub.length" class="custom-td">
                                                            {{getCalculatedMarksSub(sub.sub_id, item.exam_id,term)}}
                                                        </td>
                                                    </ng-container>

                                                    <td [attr.rowspan]="sub.childSub.length"
                                                        *ngIf="obtainedGradeAvgHighest.obtained" class="custom-td">
                                                        {{calculateTotal(sub.sub_id,term)}}
                                                        {{getSubjectPassResult(sub.sub_id,term)}}</td>
                                                    <td [attr.rowspan]="sub.childSub.length"
                                                        *ngIf="obtainedGradeAvgHighest.grade" class="custom-td">
                                                        {{calculateGrade(sub.sub_id,term)}}</td>
                                                    <ng-container *ngIf="term == data.param.eme_term_id">
                                                        <td [attr.rowspan]="sub.childSub.length"
                                                            *ngIf="obtainedGradeAvgHighest.avg" class="custom-td">
                                                            {{getClassAverage(sub.sub_id)}}</td>
                                                        <td [attr.rowspan]="sub.childSub.length"
                                                            *ngIf="obtainedGradeAvgHighest.highest" class="custom-td">
                                                            {{getClassHighest(sub.sub_id)}}</td>
                                                    </ng-container>
                                                </tr>
                                                <ng-container *ngFor="let sub1 of sub.childSub; let i=index">
                                                    <tr class="custom-tr" *ngIf="sub1.sub_type == 1 && i!=0">
                                                        <td class="custom-td text-left padding-left-8px">
                                                            {{sub1.sub_name}}
                                                        </td>
                                                        <ng-container *ngFor="let item of sexamArray">
                                                            <td class="custom-td" *ngIf="item.exam_bifurcate.bifurcated_marks">
                                                                {{getCalculatedMarksSubsubject(sub.sub_id, item.exam_id,term,sub1.sub_id)}}
                                                            </td>
                                                        </ng-container>
                                                    </tr>
                                                </ng-container>
                                            </ng-template>
                                        </ng-container>
                                        <tr class="custom-tr">
                                            <td [attr.colspan]="2" class="custom-td text-left padding-left-8px">
                                                Total({{getTotalMainSubject()}}
                                                main subject)</td>
                                            <td class="custom-td" [attr.colspan]="sexamArray.length + exambifurcateCount"></td>
                                            <td *ngIf="obtainedGradeAvgHighest.obtained" class="custom-td">
                                                {{getPassTotalPercentage(term)}}%</td>
                                            <td *ngIf="obtainedGradeAvgHighest.grade" class="custom-td"></td>
                                            <ng-container *ngIf="term == data.param.eme_term_id">
                                                <td *ngIf="obtainedGradeAvgHighest.avg" class="custom-td"></td>
                                                <td *ngIf="obtainedGradeAvgHighest.highest" class="custom-td"></td>
                                            </ng-container>
                                        </tr>
                                    </tbody>

                                </table>
                            </div>
                            <div class="col-6" *ngIf="sflag && eflag && gflag && cexamArray.length > 0">
                                <table class="custom-table table-100">
                                    <thead>
                                        <tr class="custom-tr">
                                            <th class="custom-th padding-left-8px">Co-Scholastic Areas [on a 3-point A-C
                                                grading
                                                scale ]
                                            </th>
                                            <th class="custom-th text-center">Grade</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ng-container *ngFor="let sub of subjectArray">
                                            <tr *ngIf="sub.sub_type == 2">
                                                <td class="custom-td padding-left-8px text-left">{{sub.sub_name}} </td>
                                                <td class="custom-td text-center">
                                                    {{calculateGradePoint(sub.sub_id, term)}}
                                                </td>
                                            </tr>
                                        </ng-container>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </ng-template>
                    <ng-template #not_subjectwise_bifurcation>
                        <div class="row" *ngFor="let term of termArray">
                            <div class="col-12" *ngIf="sflag && eflag && gflag && sexamArray.length > 0">
                                <table class="table-100 custom-table" style="margin-bottom: 15px">
                                    <thead>
                                        <tr class="custom-tr">
                                            <th class="custom-th text-center" width="200px">Scholastic Areas</th>
                                            <ng-container *ngIf="term == data.param.eme_term_id">
                                                <th [attr.colspan]="sexamArray.length + obtainedGradeAvgHighestCount"
                                                    class="custom-th text-center">
                                                    Term
                                                    -{{term}}
                                                    ({{acedemicmarks}} Marks)</th>
                                            </ng-container>
                                        </tr>
                                        <tr class="custom-tr">
                                            <th class="custom-th text-center">Subject Name</th>
                                            <th class="custom-th text-center" *ngFor="let item of sexamArray">
                                                {{item.exam_name | titlecase}}
                                                <br>({{item.exam_weightage}})</th>
                                            <th *ngIf="obtainedGradeAvgHighest.obtained" class="custom-th text-center">
                                                Marks
                                                Obtained<br>({{acedemicmarks}})</th>
                                            <th *ngIf="obtainedGradeAvgHighest.grade" class="custom-th text-center">
                                                Grade
                                            </th>
                                            <ng-container *ngIf="term == data.param.eme_term_id">
                                                <th *ngIf="obtainedGradeAvgHighest.avg" class="custom-th text-center">
                                                    Average
                                                </th>
                                                <th *ngIf="obtainedGradeAvgHighest.highest"
                                                    class="custom-th text-center">
                                                    Highest</th>
                                            </ng-container>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ng-container *ngFor="let sub of subjectArray">
                                            <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                <ng-container *ngIf="sub.ess_additional == 0">
                                                    <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}
                                                    </td>
                                                </ng-container>
                                                <ng-container *ngIf="sub.ess_additional == 1">
                                                    <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}
                                                        (Add.)
                                                    </td>
                                                </ng-container>
                                                <td class="custom-td" *ngFor="let item of sexamArray">
                                                    {{getCalculatedMarksSub(sub.sub_id, item.exam_id,term)}}</td>
                                                <td *ngIf="obtainedGradeAvgHighest.obtained" class="custom-td">
                                                    {{calculateTotal(sub.sub_id,term)}}
                                                    {{getSubjectPassResult(sub.sub_id,term)}}</td>
                                                <td *ngIf="obtainedGradeAvgHighest.grade" class="custom-td">
                                                    {{calculateGrade(sub.sub_id,term)}}</td>
                                                <ng-container *ngIf="term == data.param.eme_term_id">
                                                    <td *ngIf="obtainedGradeAvgHighest.avg" class="custom-td">
                                                        {{getClassAverage(sub.sub_id)}}</td>
                                                    <td *ngIf="obtainedGradeAvgHighest.highest" class="custom-td">
                                                        {{getClassHighest(sub.sub_id)}}</td>
                                                </ng-container>

                                            </tr>
                                        </ng-container>
                                        <tr class="custom-tr">
                                            <td class="custom-td text-left padding-left-8px">
                                                Total({{getTotalMainSubject()}}
                                                main subject)</td>
                                            <td class="custom-td" [attr.colspan]="sexamArray.length"></td>
                                            <td *ngIf="obtainedGradeAvgHighest.obtained" class="custom-td">
                                                {{getPassTotalPercentage(term)}}%</td>
                                            <td *ngIf="obtainedGradeAvgHighest.grade" class="custom-td"></td>
                                            <ng-container *ngIf="term == data.param.eme_term_id">
                                                <td *ngIf="obtainedGradeAvgHighest.avg" class="custom-td"></td>
                                                <td *ngIf="obtainedGradeAvgHighest.highest" class="custom-td"></td>
                                            </ng-container>
                                        </tr>
                                    </tbody>

                                </table>
                            </div>
                            <div class="col-6" *ngIf="sflag && eflag && gflag && cexamArray.length > 0">
                                <table class="custom-table table-100">
                                    <thead>
                                        <tr class="custom-tr">
                                            <th class="custom-th padding-left-8px">Co-Scholastic Areas [on a 3-point A-C
                                                grading
                                                scale ]
                                            </th>
                                            <th class="custom-th text-center">Grade</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ng-container *ngFor="let sub of subjectArray">
                                            <tr *ngIf="sub.sub_type == 2">
                                                <td class="custom-td padding-left-8px text-left">{{sub.sub_name}} </td>
                                                <td class="custom-td text-center">
                                                    {{calculateGradePoint(sub.sub_id, term)}}
                                                </td>
                                            </tr>
                                        </ng-container>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </ng-template>
                </ng-template>
                <ng-template #ccepattern>
                    <div class="row" *ngFor="let term of termArray">
                        <div class="col-12" *ngIf="sflag && eflag && gflag">
                            <table class="table-100 custom-table" style="margin-bottom: 15px">
                                <thead>
                                    <tr class="custom-tr">
                                        <th [attr.colspan]="2" class="custom-th text-center" width="200px">Scholastic
                                            Areas</th>
                                        <ng-container *ngIf="obtainedGradeAvgHighest.remark">
                                            <th [attr.colspan]="2" class="custom-th text-center">Term -{{term}} </th>
                                        </ng-container>
                                        <ng-container *ngIf="!obtainedGradeAvgHighest.remark">
                                            <th class="custom-th text-center">Term -{{term}} </th>
                                        </ng-container>
                                    </tr>
                                    <tr class="custom-tr">
                                        <ng-container *ngIf="obtainedGradeAvgHighest.remark">
                                            <th width="40%" [attr.colspan]="2" class="custom-th text-center">Subject
                                                Name
                                            </th>
                                            <th width="5%" class="custom-th text-center">Grade</th>
                                            <th *ngIf="obtainedGradeAvgHighest.remark" width="55%"
                                                class="custom-th text-center">Remark</th>
                                        </ng-container>
                                        <ng-container *ngIf="!obtainedGradeAvgHighest.remark">
                                            <th width="80%" [attr.colspan]="2" class="custom-th text-center">Subject
                                                Name
                                            </th>
                                            <th width="20%" class="custom-th text-center">Grade</th>
                                        </ng-container>

                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- <ng-container *ngFor="let sub of subjectArray">
                                        <ng-template [ngIf]="sub.childSub.length == 0" [ngIfElse]="childdiv">
                                            <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                <td class="custom-td text-left padding-left-8px">{{sub.sub_name | titlecase}}</td>
                                                <td class="custom-td">{{calculateGradeCcePoint(sub.sub_id,term)}}</td>
                                                <td class="custom-td">{{remarkOfSub(sub.sub_id) | titlecase}}</td>
                                            </tr>
                                        </ng-template>
                                        <ng-template #childdiv>
                                            <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                <td class="custom-td text-left padding-left-8px">{{sub.sub_name}}</td>
                                                <td class="custom-td"></td>
                                                <td class="custom-td"></td>
                                            </tr>
                                            <ng-container *ngFor="let sub1 of sub.childSub">
                                                <tr class="custom-tr" *ngIf="sub1.sub_type == 1">
                                                    <td class="custom-td text-left padding-left-8px">{{sub1.sub_name}}</td>
                                                    <td class="custom-td">{{calculateGradeCcePoint(sub1.sub_id,term)}}</td>
                                                    <td class="custom-td">{{remarkOfSub(sub1.sub_id) | titlecase}}</td>
                                                </tr>
                                            </ng-container>
                                        </ng-template>
                                    </ng-container> -->
                                    <ng-container *ngFor="let sub of subjectArray">
                                        <ng-template [ngIf]="sub.childSub.length == 0" [ngIfElse]="childdiv1">
                                            <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                <td class="custom-td text-left padding-left-8px" [attr.colspan]="2">
                                                    {{sub.sub_name | titlecase}}</td>
                                                <td class="custom-td">{{calculateGradeCcePoint(sub.sub_id,term)}}</td>
                                                <td *ngIf="obtainedGradeAvgHighest.remark" class="custom-td">
                                                    {{remarkOfSub(sub.sub_id) | titlecase}}</td>
                                            </tr>
                                        </ng-template>
                                        <ng-template #childdiv1>
                                            <tr class="custom-tr" *ngIf="sub.sub_type == 1">
                                                <td class="custom-td text-left padding-left-8px"
                                                    [attr.rowspan]="sub.childSub.length">{{sub.sub_name}}</td>
                                                <td class="custom-td text-left padding-left-8px">
                                                    {{sub.childSub[0].sub_name}}</td>
                                                <td class="custom-td">
                                                    {{calculateGradeCcePoint(sub.childSub[0].sub_id,term)}}</td>
                                                <td *ngIf="obtainedGradeAvgHighest.remark" class="custom-td"></td>
                                            </tr>
                                            <ng-container *ngFor="let sub1 of sub.childSub; let i=index">
                                                <tr class="custom-tr" *ngIf="sub1.sub_type == 1 && i!=0">
                                                    <td class="custom-td text-left padding-left-8px">{{sub1.sub_name}}
                                                    </td>
                                                    <td class="custom-td">{{calculateGradeCcePoint(sub1.sub_id,term)}}
                                                    </td>
                                                    <td *ngIf="obtainedGradeAvgHighest.remark" class="custom-td">
                                                        {{remarkOfSub(sub1.sub_id) | titlecase}}</td>
                                                </tr>
                                            </ng-container>
                                        </ng-template>
                                    </ng-container>
                                </tbody>

                            </table>
                        </div>
                        <div class="col-12" *ngIf="sflag && eflag && gflag && cexamArray.length > 0">
                            <table class="custom-table table-100">
                                <!-- <thead>
                                    <tr class="custom-tr">
                                        <th class="custom-th padding-left-8px">Co-Scholastic Areas [on a 3-point A-C
                                            grading
                                            scale ]
                                        </th>
                                        <th class="custom-th text-center">Grade</th>
                                    </tr>
                                </thead> -->
                                <thead>
                                    <tr class="custom-tr">
                                        <!-- <th class="custom-th text-center" *ngFor="let item of sexamArray">
                                            {{item.exam_name | titlecase}}
                                            <br>({{item.exam_weightage}})</th> -->
                                        <ng-container *ngIf="obtainedGradeAvgHighest.remark">
                                            <th width="40%" [attr.colspan]="2" class="custom-th text-center">
                                                Co-Scholastic Areas
                                            </th>
                                            <th width="5%" class="custom-th text-center">Grade</th>
                                            <th *ngIf="obtainedGradeAvgHighest.remark" width="55%"
                                                class="custom-th text-center">Remark</th>
                                        </ng-container>
                                        <ng-container *ngIf="!obtainedGradeAvgHighest.remark">
                                            <th width="80%" [attr.colspan]="2" class="custom-th text-center">
                                                Co-Scholastic Areas
                                            </th>
                                            <th width="20%" class="custom-th text-center">Grade</th>
                                        </ng-container>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- <ng-container *ngFor="let sub of subjectArray">
                                        <tr *ngIf="sub.sub_type == 2">
                                            <td class="custom-td padding-left-8px text-left">{{sub.sub_name}} </td>
                                            <td class="custom-td text-center">
                                                {{calculateGradePoint(sub.sub_id, term)}}
                                            </td>
                                        </tr>
                                    </ng-container> -->
                                    <ng-container *ngFor="let sub of subjectArray">
                                        <ng-template [ngIf]="sub.childSub.length == 0" [ngIfElse]="childdiv2">
                                            <tr class="custom-tr" *ngIf="sub.sub_type == 2">
                                                <td class="custom-td text-left padding-left-8px" [attr.colspan]="2">
                                                    {{sub.sub_name | titlecase}}</td>
                                                <td class="custom-td">{{calculateGradePoint(sub.sub_id,term)}}</td>
                                                <td *ngIf="obtainedGradeAvgHighest.remark" class="custom-td">
                                                    {{remarkOfSub(sub.sub_id) | titlecase}}</td>
                                            </tr>
                                        </ng-template>
                                        <ng-template #childdiv2>
                                            <tr class="custom-tr" *ngIf="sub.sub_type == 2">
                                                <td class="custom-td text-left padding-left-8px"
                                                    [attr.rowspan]="sub.childSub.length">{{sub.sub_name}}</td>
                                                <td class="custom-td text-left padding-left-8px">
                                                    {{sub.childSub[0].sub_name}}</td>
                                                <td class="custom-td">
                                                    {{calculateGradePoint(sub.childSub[0].sub_id,term)}}</td>
                                                <td *ngIf="obtainedGradeAvgHighest.remark" class="custom-td"></td>
                                            </tr>
                                            <ng-container *ngFor="let sub1 of sub.childSub; let i=index">
                                                <tr class="custom-tr" *ngIf="sub1.sub_type == 2 && i!=0">
                                                    <td class="custom-td text-left padding-left-8px">{{sub1.sub_name}}
                                                    </td>
                                                    <td class="custom-td">{{calculateGradePoint(sub1.sub_id,term)}}
                                                    </td>
                                                    <td *ngIf="obtainedGradeAvgHighest.remark" class="custom-td">
                                                        {{remarkOfSub(sub1.sub_id) | titlecase}}</td>
                                                </tr>
                                            </ng-container>
                                        </ng-template>
                                    </ng-container>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </ng-template>
            </ng-container>


            <div class="row" *ngIf="resultdivflag && data.ect_exam_type == 2">
                <div class="col-12">
                    <table>
                        <thead>
                            <tr><br></tr>
                            <tr>
                                <td width="20%" valign="top">Class Teacher's Remarks</td>
                                <td width="1%" valign="top">:</td>
                                <td>{{remarkOfSub() | titlecase}}</td>
                            </tr>
                            <tr><br></tr>
                            <tr class="margin-top-10">
                                <td style="text-align: left">Result</td>
                                <td>:</td>
                                <td>{{getPassResult(data.param.eme_term_id)}}</td>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <table class="table-100">
                        <tr>
                            <th height="80" style="text-align: left; vertical-align: bottom;">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>: {{today | date:'d-MMM-y'}}</th>
                                        </tr>
                                    </thead>
                                </table>
                            </th>
                            <th style="text-align: center; vertical-align: bottom;" height="80">
                                <table>
                                    <thead>
                                        <tr>
                                            <th *ngIf="useTeacherSignature === '1' && teacherSignature"> <img
                                                    [src]="teacherSignature" height="60px" width="160px"></th>
                                        </tr>
                                        <tr>
                                            <th>Signature of Class Teacher</th>
                                        </tr>
                                    </thead>
                                </table>
                            </th>
                            <th style="text-align: right; vertical-align: bottom;" height="80">
                                <table>
                                    <thead>
                                        <tr>
                                            <th *ngIf="usePrincipalSignature === '1' && principalSignature"> <img
                                                    [src]="principalSignature" height="60px" width="120px"></th>
                                        </tr>
                                        <tr>
                                            <th>Signature of Principal</th>
                                        </tr>
                                    </thead>
                                </table>
                            </th>
                        </tr>
                    </table>
                </div>
            </div>
            <hr>
            <div class="row"
                *ngIf="data.ect_exam_type == 2 && !(data.param.eme_subexam_id && data.param.eme_subexam_id.length > 0)">
                <div class="col-12">
                    <span><b>Grading Scale for scholatic Area</b></span><span> : Grades are awarded on a 8-pont grading
                        scale as
                        follows</span>
                </div>
            </div>
            <div class="row"
                *ngIf="data.ect_exam_type == 2 && !(data.param.eme_subexam_id && data.param.eme_subexam_id.length > 0)">
                <div class="col-12">

                    <div style="margin-top: 15px; text-align: center; width: 100%;">
                        <table style="width:100%; border: 1px solid black;border-collapse: collapse;">
                            <tbody>
                                <tr>
                                    <th style="border: 1px solid black;border-collapse: collapse;padding: 5px">Marks
                                        Range </th>
                                    <td *ngFor="let item of GradeSet"
                                        style="border: 1px solid black;border-collapse: collapse;padding: 5px">
                                        {{item.egs_range_start}} - {{item.egs_range_end}}
                                    </td>
                                </tr>
                                <tr>
                                    <th style="border: 1px solid black;border-collapse: collapse;padding: 5px">Grade
                                    </th>
                                    <td *ngFor="let item of GradeSet"
                                        style="border: 1px solid black;border-collapse: collapse;padding: 5px">
                                        {{item.egs_grade_name | titlecase}}</td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <br>
            <div class="">
                <div [innerHTML]="footer"></div>
                <div style="width: 100%; height:10px; background-color:#f4981e;"></div>
                <div style="width: 100%; height:10px; background-color:#159ec4"></div>

            </div>
        </td>
    </tr>
</table>