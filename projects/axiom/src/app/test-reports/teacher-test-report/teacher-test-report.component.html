<simple-notifications></simple-notifications>
<div class="row">
  <div class="col-12">
    <mat-card>
      <mat-card-title>
        <h1 class="remove-bottom-margin font-size-24">Test Report And Analysis</h1>
      </mat-card-title>
    </mat-card>
  </div>
</div>
<div class="row">
  <div class="col-12 ">
    <mat-card>
      <mat-card-content>
        <div class="row">
          <div class="col-lg-12 pd_left pd_right">
            <form [formGroup]="teacherreportfilter" novalidate>
              <div class="row">
                <div class="col-lg-2">
                  <mat-form-field class="form-field" appearance="outline">
                    <mat-label>Class</mat-label>
                    <mat-select placeholder="Class" formControlName="es_class_id"
                      (selectionChange)="getSectionsByClass();getSubjectsByClass()" required>
                      <mat-option *ngFor="let item of classArray" [value]="item.class_id">
                        {{item.class_name}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col-lg-2">
                  <mat-form-field class="form-field" appearance="outline">
                    <mat-label>Section</mat-label>
                    <mat-select placeholder="Section" formControlName="es_sec_id" required>
                      <mat-option *ngFor="let item of sectionsArray" [value]="item.sec_id">
                        {{item.sec_name}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col-lg-2">
                  <mat-form-field class="form-field" appearance="outline">
                    <mat-label>Subject</mat-label>
                    <mat-select placeholder="Subject" formControlName="es_sub_id" required>
                      <mat-option *ngFor="let item of subjectArray" [value]="item.sub_id">
                        {{item.sub_name}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col-lg-2">
                  <mat-form-field class="form-field" appearance="outline">
                    <mat-label>Exam Type</mat-label>
                    <mat-select placeholder="Exam Type" formControlName="es_exam_type">
                      <mat-option *ngFor="let item of examTypeArray" [value]="item.exam_type_id">
                        {{item.exam_type_name}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col-lg-2">
                  <div class="mt-3">
                    <button mat-raised-button class="submit-button" (click)="getScheduleExam()">Apply</button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12 col-mobile-view-add-ques">
            <div *ngIf="tableCollection">
              <div class="example-container table-box-main">
                <div class="col-2">
                  <mat-form-field class="form-field">
                    <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
                    <span matPrefix><i class="fas fa-sliders-h table-filter-icon"></i>&nbsp;&nbsp;</span>
                  </mat-form-field>
                </div>
                <mat-table class="specific-table table-100" #table [dataSource]="dataSource" matSort>
                  <!-- Position Column -->
                  <ng-container matColumnDef="position">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> No. </mat-header-cell>
                    <mat-cell *matCellDef="let item"> {{item.position}} </mat-cell>
                  </ng-container>
                  <!-- Template Name Column -->
                  <ng-container matColumnDef="name">
                    <mat-header-cell *matHeaderCellDef mat-sort-header>Test Name
                    </mat-header-cell>
                    <mat-cell *matCellDef="let item"> {{item.name}} </mat-cell>
                  </ng-container>
                  <!-- duration Column -->
                  <ng-container matColumnDef="class">
                    <mat-header-cell *matHeaderCellDef mat-sort-header>Class </mat-header-cell>
                    <mat-cell *matCellDef="let item"> {{item.class}}-{{item.section}}
                    </mat-cell>
                  </ng-container>
                  <!-- Location Column -->
                  <ng-container matColumnDef="subject">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Subject
                    </mat-header-cell>
                    <mat-cell *matCellDef="let item"> {{item.subject}} </mat-cell>
                  </ng-container>
                  <!--date Column -->
                  <ng-container matColumnDef="date">
                    <mat-header-cell *matHeaderCellDef mat-sort-header>Date </mat-header-cell>
                    <mat-cell *matCellDef="let item"> {{item.date}} </mat-cell>
                  </ng-container>
                  <!-- Time Column -->
                  <ng-container matColumnDef="time">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Time</mat-header-cell>
                    <mat-cell *matCellDef="let item"> {{item.time}} </mat-cell>
                  </ng-container>
                  <!--Duration-->
                  <ng-container matColumnDef="duration">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Duration
                    </mat-header-cell>
                    <mat-cell *matCellDef="let item"> {{item.duration}} Min.</mat-cell>
                  </ng-container>
                  <!--Max Marks-->
                  <ng-container matColumnDef="marks">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Max Marks
                    </mat-header-cell>
                    <mat-cell *matCellDef="let item"> {{item.marks}} </mat-cell>
                  </ng-container>
                  <!--Student Appeared-->
                  <ng-container matColumnDef="appeared">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Student Appeared
                    </mat-header-cell>
                    <mat-cell *matCellDef="let item"> {{item.appeared}} </mat-cell>
                  </ng-container>
                  <!--Action-->
                  <ng-container matColumnDef="action">
                    <mat-header-cell *matHeaderCellDef> Action </mat-header-cell>
                    <mat-cell *matCellDef="let item">
                      <i style="color: #1e9bb7; font-size: 16px; cursor: pointer" class="fas fa-sync-alt"
                        matTooltip="Re-Evaluate Test" (click)="reEvaluateTest(item.action.es_id)"></i>&nbsp;&nbsp;
                      <a [routerLink]="['../report-analysis',item.action.es_id]">
                        <i style="font-size: 16px" class="fas fa-folder-open" aria-hidden="true" data-toggle="tooltip"
                          data-placement="top" matTooltip="View Test Report" aria-hidden="true"></i>&nbsp;&nbsp;
                        <i *ngIf="currentUser.role_id == 2" class="far fa-trash-alt table-delete-icon"
                          data-toggle="tooltip" data-placement="top" matTooltip="Delete" aria-hidden="true"
                          (click)="openModal(template);setDeleteExam(item.action.es_id)"></i>
                      </a>
                    </mat-cell>;
                  </ng-container>
                  <mat-header-row class="top_header" *matHeaderRowDef="displayedColumns">
                  </mat-header-row>
                  <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
                </mat-table>
                <mat-paginator #paginator [pageSize]="10" [pageSizeOptions]="[10,20,30]" [showFirstLastButtons]="true">
                </mat-paginator>
              </div>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>

<app-delete-modal #deleteModalRef [deleteMessage]="'Are you Sure? You want to Delete '"
  (deleteOk)="deleteExam(deleted_es_id)" (deleteCancel)="deleteComCancel()">
</app-delete-modal>