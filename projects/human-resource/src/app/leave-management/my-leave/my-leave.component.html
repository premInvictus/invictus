<div>
    <div class="row">
        <div class="col-12 ">
            <mat-card class="card-top-title__container">
                <div class="row">
                    <div class="col-6 remove-col-padding-left">
                        <h1 class="remove-bottom-margin font-size-24">My Leave Management</h1>
                    </div>
                </div>
            </mat-card>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <mat-card class="card-height-760 card-height-880">
                <mat-tab-group (selectedTabChange)="changeTab($event)" class="padding-8">
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <div>
                                <span>My Leave</span>
                            </div>
                        </ng-template>

                        <div class="col-12 text-right margin-top-10 position-right">
                            <button mat-button class="font-size-14 margin-left-10 font-white  btn-blue"
                                (click)="applyForLeave()">Apply For Leave
                            </button>
                        </div>
                        <form [formGroup]="leaveForm" *ngIf="showFormFlag">
                            <div class="row">
                                <div class="col-4">
                                    <mat-form-field class="form-field" appearance="outline">
                                        <mat-label>Leave Type</mat-label>
                                        <mat-select (selectionChange)="getLeaveType()" placeholder="Leave Type"
                                            formControlName="leave_type" required>
                                            <mat-option value="">Please select</mat-option>
                                            <mat-option *ngFor="let item of leaveTypeArray" [value]="item.leave_id">
                                                {{item.leave_name}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-4">
                                    <mat-form-field appearance="outline" class="form-field">
                                        <mat-label>Leave Start Date</mat-label>
                                        <input matInput [matDatepicker]="picker" placeholder="Choose a date"
                                            formControlName="leave_start_date" required>
                                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                        <mat-datepicker #picker></mat-datepicker>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-4">
                                    <mat-form-field appearance="outline" class="form-field">
                                        <mat-label>Leave End Date</mat-label>
                                        <input matInput [matDatepicker]="picker1" placeholder="Choose a date"
                                            formControlName="leave_end_date" required>
                                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                        <mat-datepicker #picker1></mat-datepicker>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-4">
                                    <mat-form-field appearance="outline" class="mat-form-field" style="width: 430px;">
                                        <mat-label>Reason</mat-label>
                                        <textarea matInput rows="3" cols="50" placeholder="Reason"
                                            formControlName="leave_reason" required></textarea>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-4">
                                    <input style="display:none;" #inputFile type="file" name="uploadFile"
                                        id="bulkupdate" (change)="uploadAttachment($event)">
                                    <label class="my-filter-btn mat-raised-button" for="bulkupdate"> <i
                                            class="fas fa-cloud-upload-alt"></i>
                                        Attachment</label>
                                    <div *ngIf="attachmentArray && attachmentArray[0]">
                                        <img [src]="attachmentArray[0]['file_url']" height="100" width="100"/>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-2" *ngIf="!editFlag">
                                    <button mat-button class="font-size-14 margin-left-10 font-white  btn-green"
                                        (click)="submit()">Submit</button>
                                </div>

                                <div class="col-2" *ngIf="editFlag">
                                    <button mat-button class="font-size-14 margin-left-10 font-white  btn-green"
                                        (click)="update()">Update</button>
                                </div>
                                <div class="col-2">
                                    <button mat-button class="font-size-14 font-white  btn-danger" style="height: 36px"
                                        (click)="reset()">Reset</button>
                                </div>
                            </div>
                        </form>
                        <div class="row">
                            <div class="col-6">
                                <mat-form-field [hidden]="!(MY_LEAVE_ELEMENT_DATA.length > 0)">
                                    <input matInput placeholder="Filter" #input (keyup)="myLeaveFilter(input.value)">
                                    <i class="fas fa-filter table-filter" matPrefix></i>
                                </mat-form-field>
                            </div>
                            <div class="col-6">
                                &nbsp;
                            </div>
                        </div>
                        <div class="row" [hidden]="!(MY_LEAVE_ELEMENT_DATA.length > 0)">
                            <div class="col-12">
                                <table mat-table [dataSource]="myLeaveDataSource" class="fee-table-100 text-center">
                                    <ng-container matColumnDef="srno">
                                        <th mat-header-cell *matHeaderCellDef class="text-nowrap" width="5%"> Sr. No.
                                        </th>
                                        <ng-container *matCellDef="let item">
                                            <td mat-cell class="text-nowrap">
                                                <p [innerHtml]="item?.srno"> </p>
                                            </td>
                                        </ng-container>
                                    </ng-container>
                                    <ng-container matColumnDef="leave_date">
                                        <th mat-header-cell *matHeaderCellDef width="15%"> Leave Duration </th>
                                        <td mat-cell *matCellDef="let item"
                                            class="text-nowrap text-left text-capitalize">
                                            {{item.leave_date}} </td>
                                    </ng-container>
                                    <ng-container matColumnDef="leave_type">
                                        <th mat-header-cell *matHeaderCellDef width="10%"> Leave Type </th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap text-capitalize">
                                            {{item.leave_type}}
                                        </td>
                                    </ng-container>
                                    <ng-container matColumnDef="leave_balance">
                                        <th mat-header-cell *matHeaderCellDef width="10%"> Leave Balance </th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap text-capitalize">
                                            {{item.leave_balance}}
                                        </td>
                                    </ng-container>
                                    <ng-container matColumnDef="leave_no_of_days">
                                        <th mat-header-cell *matHeaderCellDef width="15%"> Leave (No. of Days)</th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap">
                                            <p [innerHtml]="item?.leave_no_of_days"> </p>
                                        </td>
                                    </ng-container>
                                    <ng-container matColumnDef="leave_reason">
                                        <th mat-header-cell *matHeaderCellDef width="30%"> Reason </th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap text-left">
                                            {{item.leave_reason}} </td>
                                    </ng-container>
                                    <ng-container matColumnDef="status">
                                        <th mat-header-cell *matHeaderCellDef width="10%"> Status </th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap text-capitalize">

                                        </td>
                                    </ng-container>
                                    <ng-container matColumnDef="action">
                                        <th mat-header-cell *matHeaderCellDef width="15%"> Action </th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap">
                                            <!-- <span *ngIf="(item.security_status ==='2') && !(item.srno==='Total')"><a
                                                    href="javascript:void(0)" (click)="viewReceipt(item?.action)"><i
                                                        class="fas fa-print"></i></a></span> -->
                                            <i class="fas fa-edit font-color-grey margin-right-15"
                                                style="font-size:16px;" (click)="editLeave(item?.action)"></i>
                                            <i class="fas fa-times-circle font-color-grey margin-right-15"
                                                style="font-size:16px;color:red" (click)="deleteLeave(item?.action)"></i>
                                            <i class="fas fa-file font-color-grey margin-right-15"
                                                style="font-size:16px;color:black" (click)="viewAttachment(item?.action)"></i>
                                        </td>
                                    </ng-container>
                                    <tr mat-header-row *matHeaderRowDef="myLeaveDisplayedColumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: myLeaveDisplayedColumns;">
                                    </tr>
                                </table>
                                <mat-paginator [hidden]="!(MY_LEAVE_ELEMENT_DATA.length > 0)" #myLeavePaginator
                                    [pageSize]="100" [pageSizeOptions]="[100,300,500,1000]">
                                </mat-paginator>
                            </div>
                        </div>
                        <div class="text-center" *ngIf="MY_LEAVE_ELEMENT_DATA.length == 0 && !showFormFlag">

                            <div class="smart-das-icon">
                                <img src="https://s3.ap-south-1.amazonaws.com/files.invictusdigisoft.com/images/smart-dashboard.png"
                                    class="smart-icon-img" />
                                <br>
                                <span class="desc-span-smart-dash">No Leave Record Found</span><br>
                            </div>

                        </div>
                    </mat-tab>
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <div>
                                <span>My Subordinate</span>
                            </div>
                        </ng-template>
                        <div class="row">
                            <div class="col-6">

                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <mat-form-field [hidden]="!(SUBORDINATE_LEAVE_ELEMENT_DATA.length > 0)">
                                    <input matInput placeholder="Filter" #input (keyup)="myLeaveFilter(input.value)">
                                    <i class="fas fa-filter table-filter" matPrefix></i>
                                </mat-form-field>
                            </div>
                            <div class="col-6">
                                &nbsp;
                            </div>
                        </div>
                        <div class="row" [hidden]="!(SUBORDINATE_LEAVE_ELEMENT_DATA.length > 0)">
                            <div class="col-12">
                                <table mat-table [dataSource]="subordinateLeaveDataSource"
                                    class="fee-table-100 text-center">
                                    <ng-container matColumnDef="srno">
                                        <th mat-header-cell *matHeaderCellDef class="text-nowrap" width="5%"> Sr. No.
                                        </th>
                                        <ng-container *matCellDef="let item">
                                            <td mat-cell class="text-nowrap">
                                                <p [innerHtml]="item?.srno"> </p>
                                            </td>
                                        </ng-container>
                                    </ng-container>
                                    <ng-container matColumnDef="emp_id">
                                        <th mat-header-cell *matHeaderCellDef class="text-nowrap" width="5%"> Emp. ID
                                        </th>
                                        <ng-container *matCellDef="let item">
                                            <td mat-cell class="text-nowrap">
                                                <p [innerHtml]="item?.emp_id"> </p>
                                            </td>
                                        </ng-container>
                                    </ng-container>
                                    <ng-container matColumnDef="emp_name">
                                        <th mat-header-cell *matHeaderCellDef class="text-nowrap" width="15%"> Emp Name
                                        </th>
                                        <ng-container *matCellDef="let item">
                                            <td mat-cell class="text-nowrap text-left">
                                                <p [innerHtml]="item?.emp_name"> </p>
                                            </td>
                                        </ng-container>
                                    </ng-container>
                                    <ng-container matColumnDef="leave_date">
                                        <th mat-header-cell *matHeaderCellDef width="15%"> Leave Duration </th>
                                        <td mat-cell *matCellDef="let item"
                                            class="text-nowrap text-left text-capitalize">
                                            {{item.leave_date}} </td>
                                    </ng-container>
                                    <ng-container matColumnDef="leave_type">
                                        <th mat-header-cell *matHeaderCellDef width="10%"> Leave Type </th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap text-capitalize">
                                            {{item.leave_type}}
                                        </td>
                                    </ng-container>
                                    <ng-container matColumnDef="leave_balance">
                                        <th mat-header-cell *matHeaderCellDef width="10%"> Leave Balance </th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap text-capitalize">
                                            {{item.leave_balance}}
                                        </td>
                                    </ng-container>
                                    <ng-container matColumnDef="leave_no_of_days">
                                        <th mat-header-cell *matHeaderCellDef width="10%"> Leave (No. of Days)</th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap">
                                            <p [innerHtml]="item?.leave_no_of_days"> </p>
                                        </td>
                                    </ng-container>
                                    <ng-container matColumnDef="leave_reason">
                                        <th mat-header-cell *matHeaderCellDef width="20%"> Reason </th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap text-left">
                                            {{item.leave_reason}} </td>
                                    </ng-container>
                                    <ng-container matColumnDef="status">
                                        <th mat-header-cell *matHeaderCellDef width="5%"> Status </th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap text-capitalize">

                                        </td>
                                    </ng-container>
                                    <ng-container matColumnDef="action">
                                        <th mat-header-cell *matHeaderCellDef width="10%"> Action </th>
                                        <td mat-cell *matCellDef="let item" class="text-nowrap">
                                            <i class="fa fa-thumbs-up" aria-hidden="true" style="color:green" (click)="approveLeave(item?.action)"></i>
                                            &nbsp;&nbsp;
                                            <i class="fa fa-thumbs-down" aria-hidden="true" style="color:red" (click)="rejectLeave(item?.action)"></i>
                                        </td>
                                    </ng-container>
                                    <tr mat-header-row *matHeaderRowDef="subordinateDisplayedColumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: subordinateDisplayedColumns;">
                                    </tr>
                                </table>
                                <mat-paginator [hidden]="!(SUBORDINATE_LEAVE_ELEMENT_DATA.length > 0)"
                                    #subordinateLeavePaginator [pageSize]="100" [pageSizeOptions]="[100,300,500,1000]">
                                </mat-paginator>
                            </div>
                        </div>
                        <div class="text-center" *ngIf="SUBORDINATE_LEAVE_ELEMENT_DATA.length == 0">

                            <div class="smart-das-icon">
                                <img src="https://s3.ap-south-1.amazonaws.com/files.invictusdigisoft.com/images/smart-dashboard.png"
                                    class="smart-icon-img" />
                                <br>
                                <span class="desc-span-smart-dash">No Subordinate Record Found</span><br>
                            </div>

                        </div>
                    </mat-tab>
                </mat-tab-group>
            </mat-card>
        </div>
    </div>
</div>
<app-delete-modal #deleteModal [deleteMessage]="deleteMessage" (deleteOk)="deleteConfirm($event)"
    (deleteCancel)="deleteCancel()"></app-delete-modal>

<app-delete-modal #approveModal [deleteMessage]="approveMessage" (deleteOk)="approveConfirm($event)"
    (deleteCancel)="deleteCancel()"></app-delete-modal>

<app-delete-modal #rejectModal [deleteMessage]="rejectMessage" (deleteOk)="rejectConfirm($event)"
    (deleteCancel)="deleteCancel()"></app-delete-modal>